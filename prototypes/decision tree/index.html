<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="stylesheet" href="css/styles.css" />
    <script type="text/javascript" src="js/index.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Decision Tree</title>
</head>

<body>
    <div class="container">
        <div class="row p-2">
            <!-- Info card -->
            <div class="row-auto p-2">
                <div class="accordion" id="accordionInfo">
                    <div class="card bg-light mx-auto ">
                        <!-- General Info -->
                        <div class="card-header fs-5" id="generalInfo">
                            <a class="collapsed d-block link-body-emphasis link-offset-2 link-offset-2-hover link-underline link-underline-opacity-0 link-underline-opacity-50-hover"
                                data-bs-toggle="collapse" href="#generalInfoDT" aria-expanded="false"
                                aria-controls="generalInfoDT">
                                General Information
                            </a>
                        </div>
                        <div class="collapse" id="generalInfoDT" aria-labelledby="generalInfo"
                            data-parent="#accordionInfo">
                            <div class="card-body ">
                                <p class="card-text fw-light">
                                    Decision trees are a popular and versatile supervised machine learning algorithm
                                    used for both classification and regression tasks.
                                    They are powerful models that aim to mimic human decision-making processes.
                                </p>
                                <p class="card-text fw-light">
                                    A decision tree consists of a tree-like structure where:
                                <ul class="card-text fw-light">
                                    <li>each internal node, also called decision node, represents a decision based on a
                                        feature,</li>
                                    <li>each branch represents the outcome of the decision,</li>
                                    <li>and each leaf node represents the predicted class label.</li>
                                </ul>
                                </p>
                                <p class="card-text fw-light">
                                    Decision trees are constructed using a top-down, recursive partitioning approach
                                    called "Top-Down Induction of Decision Trees (TDIDT)".
                                    The algorithm selects the best attribute/feature to split the dataset into subsets
                                    at each node based on a criterion, such as "Information Gain" or "Gini impurity"
                                    (this application uses "Information Gain").
                                    This process continues until all instances within a subset belong to the same class
                                    or have similar values and therefore represent a leaf node.
                                </p>
                                <a href="https://en.wikipedia.org/wiki/Decision_tree"
                                    class="btn btn-outline-dark ">Learn more</a>
                            </div>
                        </div>

                        <!-- Algorithm -->
                        <div class="card-header fs-5" id="algorithm">
                            <a class="collapsed d-block link-body-emphasis link-offset-2 link-offset-2-hover link-underline link-underline-opacity-0 link-underline-opacity-50-hover"
                                data-bs-toggle="collapse" href="#algorithmDT" aria-expanded="false"
                                aria-controls="algorithmDT">
                                ID3 Algorithm
                            </a>
                        </div>
                        <div class="collapse" id="algorithmDT" aria-labelledby="algorithm" data-parent="#accordionInfo">
                            <div class="card-body ">
                                <p class="card-text fw-bold">Input:</p>
                                <ul class="card-text fw-light ">
                                    <li>Dataset \( S \) with attributes \( A \)</li>
                                    <li>Target attribute \( Y \)</li>
                                </ul>
                                <p class="card-text fw-bold">Output:</p>
                                <ul class="card-text fw-light">
                                    <li>Decision Tree \( T \)</li>
                                </ul>
                                <p class="card-text fw-bold">Algorithm:</p>
                                <ol>
                                    <li class="card-text fw-light">
                                        Start with dataset \( S \) as the root node of the tree
                                    </li>
                                    <li class="card-text fw-light">
                                        Check if all instances in \( S \) belong to the <span class="fw-bold">same
                                            class</span>:
                                        <ul>
                                            <li>If yes, create a leaf node with the class label and return \( T \)</li>
                                        </ul>
                                    </li>
                                    <li class="card-text fw-light">
                                        Check if the attribute set \( A \) is <span class="fw-bold">empty</span>:
                                        <ul>
                                            <li>If yes, create a leaf node with the most frequent class label and
                                                return \( T \)</li>
                                        </ul>
                                    </li>
                                    <li class="card-text fw-light">
                                        Calculate the information gain for each attribute in \( A \)
                                    </li>
                                    <li class="card-text fw-light">
                                        Select the attribute \( A_{\text{best}} \) with the <span
                                            class="fw-bold">highest information gain</span>
                                    </li>
                                    <li class="card-text fw-light">
                                        Make this current root node into a decision node for \( A_{\text{best}} \):
                                        <ul>
                                            <li>Split the dataset \( S \) into subsets based on the values of attribute
                                                \( A_{\text{best}} \).</li>
                                        </ul>
                                    </li>
                                    <li class="card-text fw-light">
                                        <span class="fw-bold">Recursively</span> apply the ID3 algorithm to each subset:
                                        <ul>
                                            <li>For each subset \( S_i \), create a child node.</li>
                                            <li><span class="fw-bold">Input:</span> Subset \( S_i \) with attributes \(
                                                A \setminus
                                                \{A_{\text{best}}\} \), target attribute \( Y \).</li>
                                            <li><span class="fw-bold">Output:</span> Subtree \( T_i \).</li>
                                        </ul>
                                    </li>
                                    <li class="card-text fw-light">
                                        Return the decision tree \( T \):
                                        <ul>
                                            <li>Decision tree \( T \) with root node \( A_{\text{best}} \) and subtree
                                                \( T_i \) as children.</li>
                                        </ul>
                                    </li>
                                </ol>
                            </div>
                        </div>

                        <!-- Calculation -->
                        <div class="card-header fs-5" id="calculation">
                            <a class="collapsed d-block link-body-emphasis link-offset-2 link-offset-2-hover link-underline link-underline-opacity-0 link-underline-opacity-50-hover"
                                data-bs-toggle="collapse" href="#calcInfoDT" aria-expanded="false"
                                aria-controls="calcInfoDT">
                                Calculation
                            </a>
                        </div>
                        <div class="collapse" id="calcInfoDT" aria-labelledby="calculation"
                            data-parent="#accordionInfo">
                            <div class="card-body ">
                                <p class="card-text fw-light"></p>
                                To calculate the Information Gain, the following formula is used:
                                </p>
                                <p class="card-text fw-light">
                                    \(I(S, A) =\)
                                    <a href="../entropy/index.html#calcInfoEntropy"
                                        style="text-decoration: none">\(E(S)\)</a>
                                    \( - \)
                                    <a href="../conditional entropy/index.html#calcInfoCondEntropy"
                                        style="text-decoration: none">\(E(S|A)\)</a>
                                </p>
                                <p class="card-text fw-light">
                                    Where:
                                </p>
                                <ul class="card-text fw-light">
                                    <li>\(S\) is the dataset.</li>
                                    <li>\(A\) is the attribute/set of values of that attribute.</li>
                                    <li>\(E(S)\) is the conditional entropy of the dataset given the attribute \(A\).
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row p-2">
            <!-- Data table -->
            <div class="col-auto">
                <table class="table caption-top ">
                    <caption>Example data</caption>
                    <thead class="sticky-top">
                        <tr>
                            <th style="border-right: 1px solid black;">#</th>
                            <th>Outlook</th>
                            <th>Temperature</th>
                            <th>Humidity</th>
                            <th>Windy</th>
                            <th style="border-left: 1px solid black;">Play Golf</th>
                        </tr>
                    </thead>
                    <tbody class="table-group-divider">
                        <tr>
                            <td style="border-right: 1px solid black;">1</td>
                            <td>Sunny</td>
                            <td>Hot</td>
                            <td>High</td>
                            <td>False</td>
                            <th style="border-left: 1px solid black;">No</th>
                        </tr>
                        <tr>
                            <td style="border-right: 1px solid black;">2</td>
                            <td>Sunny</td>
                            <td>Hot</td>
                            <td>High</td>
                            <td>True</td>
                            <th style="border-left: 1px solid black;">No</th>
                        </tr>
                        <tr>
                            <td style="border-right: 1px solid black;">3</td>
                            <td>Overcast</td>
                            <td>Hot</td>
                            <td>High</td>
                            <td>False</td>
                            <th style="border-left: 1px solid black;">Yes</th>
                        </tr>
                        <tr>
                            <td style="border-right: 1px solid black;">4</td>
                            <td>Rainy</td>
                            <td>Mild</td>
                            <td>High</td>
                            <td>False</td>
                            <th style="border-left: 1px solid black;">Yes</th>
                        </tr>
                        <tr>
                            <td style="border-right: 1px solid black;">5</td>
                            <td>Rainy</td>
                            <td>Cool</td>
                            <td>Normal</td>
                            <td>False</td>
                            <th style="border-left: 1px solid black;">Yes</th>
                        </tr>
                        <tr>
                            <td style="border-right: 1px solid black;">6</td>
                            <td>Rainy</td>
                            <td>Cool</td>
                            <td>Normal</td>
                            <td>True</td>
                            <th style="border-left: 1px solid black;">No</th>
                        </tr>
                        <tr>
                            <td style="border-right: 1px solid black;">7</td>
                            <td>Overcast</td>
                            <td>Cool</td>
                            <td>Normal</td>
                            <td>True</td>
                            <th style="border-left: 1px solid black;">Yes</th>
                        </tr>
                        <tr>
                            <td style="border-right: 1px solid black;">8</td>
                            <td>Sunny</td>
                            <td>Mild</td>
                            <td>High</td>
                            <td>False</td>
                            <th style="border-left: 1px solid black;">No</th>
                        </tr>
                        <tr>
                            <td style="border-right: 1px solid black;">9</td>
                            <td>Sunny</td>
                            <td>Cool</td>
                            <td>Normal</td>
                            <td>False</td>
                            <th style="border-left: 1px solid black;">Yes</th>
                        </tr>
                        <tr>
                            <td style="border-right: 1px solid black;">10</td>
                            <td>Rainy</td>
                            <td>Mild</td>
                            <td>Normal</td>
                            <td>False</td>
                            <th style="border-left: 1px solid black;">Yes</th>
                        </tr>
                        <tr>
                            <td style="border-right: 1px solid black;">11</td>
                            <td>Sunny</td>
                            <td>Mild</td>
                            <td>Normal</td>
                            <td>True</td>
                            <th style="border-left: 1px solid black;">Yes</th>
                        </tr>
                        <tr>
                            <td style="border-right: 1px solid black;">12</td>
                            <td>Overcast</td>
                            <td>Mild</td>
                            <td>High</td>
                            <td>True</td>
                            <th style="border-left: 1px solid black;">Yes</th>
                        </tr>
                        <tr>
                            <td style="border-right: 1px solid black;">13</td>
                            <td>Overcast</td>
                            <td>Hot</td>
                            <td>Normal</td>
                            <td>False</td>
                            <th style="border-left: 1px solid black;">Yes</th>
                        </tr>
                        <tr style="border-bottom: hidden;">
                            <td style="border-right: 1px solid black;">14</td>
                            <td>Rainy</td>
                            <td>Mild</td>
                            <td>High</td>
                            <td>True</td>
                            <th style="border-left: 1px solid black;">No</th>
                        </tr>
                    </tbody>
                </table>
            </div>
            <!-- Decision Tree -->
            <div class="col-auto">
                <div class="svg-container">
                    <svg id="svgDT">
                        <g id="g0">
                            <a type="button" class="btn-primary" onclick="hideChildren(this)" href="#"
                                style="text-decoration: none">
                                <ellipse id="n0" rx="12%" ry="5%" cx="50%" cy="-6%"
                                    style="fill:white;stroke:blue;stroke-width: 2;" />
                                <text x="41%" y="-4%" font-size="25" fill="black">Outlook</text>
                            </a>
                        </g>
                        <g id="g1">
                            <path id="e1" d="M88 108 200 -15" stroke-width="1" stroke="black" data-connected-to="n0" />
                            <text>
                                <textPath href="#e1" startOffset="25%">
                                    <tspan font-size="16" dy="-1%">Overcast</tspan>
                                </textPath>
                            </text>

                            <ellipse id="n1" rx="5%" ry="4%" cx="15%" cy="25%" style="fill:white;stroke:black" />
                            <text x="12%" y="26%" font-size="20" fill="black">Yes</text>
                        </g>
                        <g id="g2">
                            <path id="e2" d="M250 -4 250 100" stroke-width="1" stroke="black" data-connected-to="n0" />
                            <text>
                                <textPath href="#e2" startOffset="25%">
                                    <tspan font-size="16" dy="-1%">Sunny</tspan>
                                </textPath>
                            </text>

                            <a type="button" class="btn-primary" onclick="hideChildren(this)" href="#"
                                style="text-decoration: none">
                                <ellipse id="n2" rx="12%" ry="5%" cx="50%" cy="25%"
                                    style="fill:white;stroke:blue;stroke-width: 2;" />
                                <text x="41%" y="26.5%" font-size="23" fill="black">Humidity</text>
                            </a>
                        </g>
                        <g id="g3">
                            <path id="e3" d="M210 250 230 149" stroke-width="1" stroke="black" data-connected-to="n2" />
                            <text>
                                <textPath href="#e3" startOffset="37%">
                                    <tspan font-size="16" dy="-1%">High</tspan>
                                </textPath>
                            </text>

                            <ellipse id="n3" rx="5%" ry="4%" cx="41%" cy="54%" style="fill:white;stroke:black" />
                            <text x="38.5%" y="55%" font-size="20" fill="black">No</text>
                        </g>
                        <g id="g4">
                            <path id="e4" d="M270 149 290 250" stroke-width="1" stroke="black" data-connected-to="n2" />
                            <text>
                                <textPath href="#e4" startOffset="30%">
                                    <tspan font-size="16" dy="-1%">Normal</tspan>
                                </textPath>
                            </text>

                            <ellipse id="n4" rx="5%" ry="4%" cx="59%" cy="54%" style="fill:white;stroke:black" />
                            <text x="56%" y="55%" font-size="20" fill="black">Yes</text>
                        </g>
                        <g id="g5">
                            <path id="e5" d="M297 -15 380 108" stroke-width="1" stroke="black" data-connected-to="n0" />
                            <text>
                                <textPath href="#e5" startOffset="40%">
                                    <tspan font-size="16" dy="-1%">Rainy</tspan>
                                </textPath>
                            </text>

                            <a type="button" class="btn-primary" onclick="hideChildren(this)" href="#"
                                style="text-decoration: none">
                                <ellipse id="n5" rx="12%" ry="5%" cx="85%" cy="25%"
                                    style="fill:white;stroke:blue;stroke-width: 2;" />
                                <text x="78%" y="26.5%" font-size="23" fill="black">Windy</text>
                            </a>
                        </g>
                        <g id="g6">
                            <path id="e6" d="M390 250 400 147" stroke-width="1" stroke="black" data-connected-to="n5" />
                            <text>
                                <textPath href="#e6" startOffset="37%">
                                    <tspan font-size="16" dy="-1%">True</tspan>
                                </textPath>
                            </text>

                            <ellipse id="n6" rx="5%" ry="4%" cx="77%" cy="54%" style="fill:white;stroke:black" />
                            <text x="74.5%" y="55%" font-size="20" fill="black">No</text>
                        </g>
                        <g id="g7">
                            <path id="e7" d="M450 147 460 250" stroke-width="1" stroke="black" data-connected-to="n5" />
                            <text>
                                <textPath href="#e7" startOffset="32%">
                                    <tspan font-size="16" dy="-1%">False</tspan>
                                </textPath>
                            </text>

                            <ellipse id="n7" rx="5%" ry="4%" cx="93%" cy="54%" style="fill:white;stroke:black" />
                            <text x="90%" y="55%" font-size="20" fill="black">Yes</text>
                        </g>

                        <symbol id="node" viewBox="0 0 82 100">
                            <rect x="1" y="1" width="80" height="26" style="fill:limegreen; stroke-width:2; stroke:black;" />
                            <text id="nodeNr" x="12" y="20" font-size="18" fill="black" font-weight="500">Node </text>
                            <rect x="1" y="27" width="80" height="42" style="fill:white; stroke-width:2; stroke:black;" />
                            <text id="nodeN" x="5" y="43" font-size="16" fill="black">N = </text>
                            <path d="M 1 48 81 48" stroke="black" stroke-width="1.3" stroke-dasharray="5.3" />
                            <text id="nodeE" x="5" y="64" font-size="16" fill="black">E = </text>
                            <rect x="1" y="69" width="80" height="21" style="fill:orange; stroke-width:2; stroke:black;" />
                            <text id="nodeAttribute" x="5" y="84" font-size="16" fill="black"></text>
                        </symbol>
                        <symbol id="leaf" viewBox="0 0 82 134">
                            <rect x="1" y="1" width="80" height="26" style="fill:limegreen; stroke-width:2; stroke:black;" />
                            <text id="leafNr" x="17" y="20" font-size="18" fill="black" font-weight="500">Leaf </text>
                            <rect x="1" y="27" width="80" height="84" style="fill:white; stroke-width:2; stroke:black;" />
                            <text id="leafN" x="5" y="43" font-size="16" fill="black">N = </text>
                            <path d="M 1 48 81 48" stroke="black" stroke-width="1.3" stroke-dasharray="5.3" />
                            <text id="leafYes" x="5" y="64" font-size="16" fill="black">Yes = </text>
                            <path d="M 1 69 81 69" stroke="black" stroke-width="1.3" stroke-dasharray="5.3" />
                            <text id="leafNo" x="5" y="85" font-size="16" fill="black">No = </text>
                            <path d="M 1 90 81 90" stroke="black" stroke-width="1.3" stroke-dasharray="5.3" />
                            <text id="leafE" x="5" y="106" font-size="16" fill="black">E = </text>
                            <rect x="1" y="111" width="80" height="21" style="fill:yellow; stroke-width:2; stroke:black;" />
                            <text id="leafLabel" x="5" y="127" font-size="16" fill="black">Label: </text>
                        </symbol>
                    </svg>
                </div>
            </div>
        </div>
    </div>
    <script>
        // Get the 'use' element
        // var useElement = document.getElementById('n1');
      
        // // Get the SVG document fragment
        // var href = useElement.getAttribute('href').substring(1);
      
        // var text = document.getElementById('attribute');
        // var nodeattr = document.getElementById('nodeattr').cloneNode(true);

        // Get the rect element inside the symbol
        // var text = clone.('attribute');
      
        // Modify the rect element
        // text.innerHTML = "hallo";
        // nodeattr.setAttribute('fill', 'blue');


        function createNodes(nodeId, n, e, attribute, x, y, width, height) {
            var svgEl = document.getElementById('svgDT');
            var nodeTemplate = document.getElementById('node');
            var nodeNumber = nodeId.substring(1);
            
            // Clone the template
            var clonedTemplate = nodeTemplate.cloneNode(true);
            clonedTemplate.setAttribute('id', 'node' + nodeNumber);
            
            // Update text contents
            clonedTemplate.querySelector('#nodeNr').textContent += nodeNumber;
            clonedTemplate.querySelector('#nodeN').textContent += n;
            clonedTemplate.querySelector('#nodeE').textContent += e;
            clonedTemplate.querySelector('#nodeAttribute').textContent = attribute;
    
            // Create a new 'use' element and set the node's position attributes
            var newUse = document.createElementNS('http://www.w3.org/2000/svg', 'use');
            newUse.setAttribute('id', 'useNode' + nodeNumber);
            newUse.setAttribute('href', '#node' + nodeNumber);
            newUse.setAttribute('x', x);
            newUse.setAttribute('y', y);
            newUse.setAttribute('width', width);
            newUse.setAttribute('height', height);
            
            // Append cloned template and use element to the svg
            svgEl.appendChild(clonedTemplate);
            svgEl.appendChild(newUse);
        }

        createNodes("n1", 14, 0.94, "Outlook", 200, 300, 81, 99);
        createNodes("n2", 5, 0.97, "Humidity", 200, 400, 81, 99);

        function createLeaves(leafId, n, yes, no, e, label, x, y, width, height) {
            var svgEl = document.getElementById('svgDT');
            var leafTemplate = document.getElementById('leaf');
            var leafNumber = leafId.substring(1);
            
            // Clone the template
            var clonedTemplate = leafTemplate.cloneNode(true);
            clonedTemplate.setAttribute('id', 'leaf' + leafNumber);
            
            // Update text contents
            clonedTemplate.querySelector('#leafNr').textContent += leafNumber;
            clonedTemplate.querySelector('#leafN').textContent += n;
            clonedTemplate.querySelector('#leafYes').textContent += yes;
            clonedTemplate.querySelector('#leafNo').textContent += no;
            clonedTemplate.querySelector('#leafE').textContent += e;
            clonedTemplate.querySelector('#leafLabel').textContent += label;
    
            // Create a new 'use' element and set the leaf's position attributes
            var newUse = document.createElementNS('http://www.w3.org/2000/svg', 'use');
            newUse.setAttribute('id', 'useLeaf' + leafNumber);
            newUse.setAttribute('href', '#leaf' + leafNumber);
            newUse.setAttribute('x', x);
            newUse.setAttribute('y', y);
            newUse.setAttribute('width', width);
            newUse.setAttribute('height', height);
            
            // Append cloned template and use element to the svg
            svgEl.appendChild(clonedTemplate);
            svgEl.appendChild(newUse);
        }

        createLeaves("l1", 4, 4, 0, 0, "Yes", 282, 300, 81, 133);

        // <use href="#leaf" x="282" y="300" width="81" height="133" />

        // <use id="n1" href="#node" x="200" y="300" width="81" height="99" />

        // Update text content for instance1
        // updateTextContent('instance1', 'Dynamic Text 1', 'Dynamic Text A');

        // Update text content for instance2
        // updateTextContent('instance2', 'Dynamic Text 2', 'Dynamic Text B');
      </script>
</body>